---
title: 解決一维位置關聯點對問題的分治方法
date: 2020-05-06 22:10:53
tags: [分治]
mathjax: true
categories:
- 算法
---

## 簡要

**對於一維位置關聯點對問題，分治把樸素算法的 $O(N^2)$ 優化到 $O(Nlog_2N)$**
<!--more-->
## 問題模型

先看如下問題：
給出二維平面上的數若干點，分為紅色和藍色點，每個點上有權值

記紅點的坐標、權值為 $r^x\ r^y\ r^w$ 
記藍點的坐標、權值為 $b^x\ b^y\ b^w$ 

再給出若次詢問 $L\ R$

要求在所有點中選出一個紅點 $i$ ，一個藍點 $j$ ，滿足以下條件：

* $r^y_i <b^y_j$
* $(r^x_i<L\ and\ R<b^x_j)\ or\ (L<r^x_i\ and\ b^x_j<R)$
* $r^w_i+b^w_j$ 為滿足以上條件點對中最大的

這裡有兩個維度，在 $y$ 軸上下位置相關聯，那么面對這種情況是可以基於 $y$ 軸進行分治解決的。

每層分治都把點緃中間把上下一分為二，把上面的藍點與下面的紅點組合，就一定滿足了第一個條件

反證法容易證明對最後答案有影響的點對一定是其中一種色的點是同色點中權值最大的

記下面紅色點最大的為 $max_r$ ，上面藍色的最大的為 $max_b$

在當前層中收集所有 $(max_r,藍點)$ ， $(紅點,max_b)$ ，共 $2N$ 對點

再對兩部分分別進行分治处理。

最終得到 $O(Nlog_2N)$ 對點，解決的 $y$ 軸上的要求

對於 $x$ 軸上的要求，結合詢問用 *sweep line* 容易解決

記點對數為 $N$ ，詢問數為 $Q$ ，$M=Nlog_2N+Q$ ,總的時間為 $O(M*log_2M)$

## 算法分析

對於此類位置關聯點對的問題，可以如此分治解決

1. 當前範圍从中間一分為二，处理跨過中綫的點對
2. 以同樣的方法处理兩個子範圍

如此操作：

當前範圍內处理過的跨中綫的點對在子範圍中不會再处理到，因為兩個子範圍再不相關聯

每個可能的點對都會在某一層处理到

即**不重不漏**

如每層的处理量為$O(N)$，一共有$O(log_2N)層$，一共$(O(Nlog_2N))$

其實樹分治也是同樣的道理，把一個子樹跨過父親到另一個子樹看做跨過中綫即為同理